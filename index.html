<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>PDF íŒŒì¼ ì—…ë¡œë“œ</title>
    <!-- PDF.js ë¼ì´ë¸ŒëŸ¬ë¦¬ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <!-- Tesseract.js ë¼ì´ë¸ŒëŸ¬ë¦¬ -->
    <script src="https://cdn.jsdelivr.net/npm/tesseract.js@5.0.4/dist/tesseract.min.js"></script>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 20px;
      }

      .container {
        background: white;
        border-radius: 20px;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        padding: 40px;
        max-width: 600px;
        width: 100%;
      }

      h1 {
        color: #333;
        text-align: center;
        margin-bottom: 30px;
        font-size: 28px;
      }

      .upload-area {
        border: 3px dashed #667eea;
        border-radius: 15px;
        padding: 40px;
        text-align: center;
        background: #f8f9ff;
        transition: all 0.3s ease;
        cursor: pointer;
        margin-bottom: 20px;
      }

      .upload-area:hover {
        border-color: #764ba2;
        background: #f0f2ff;
      }

      .upload-area.dragover {
        border-color: #764ba2;
        background: #e8ebff;
        transform: scale(1.02);
      }

      .upload-icon {
        font-size: 64px;
        color: #667eea;
        margin-bottom: 20px;
      }

      .upload-text {
        color: #666;
        font-size: 16px;
        margin-bottom: 10px;
      }

      .upload-hint {
        color: #999;
        font-size: 14px;
      }

      #fileInput {
        display: none;
      }

      .file-info {
        margin-top: 20px;
        padding: 15px;
        background: #f0f2ff;
        border-radius: 10px;
        display: none;
      }

      .file-info.show {
        display: block;
      }

      .file-name {
        font-weight: bold;
        color: #333;
        margin-bottom: 5px;
      }

      .file-size {
        color: #666;
        font-size: 14px;
      }

      .buttons {
        display: flex;
        gap: 10px;
        margin-top: 20px;
      }

      button {
        flex: 1;
        padding: 15px;
        border: none;
        border-radius: 10px;
        font-size: 16px;
        font-weight: bold;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .upload-btn {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
      }

      .upload-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
      }

      .upload-btn:disabled {
        background: #ccc;
        cursor: not-allowed;
        transform: none;
      }

      .reset-btn {
        background: #f0f0f0;
        color: #333;
      }

      .reset-btn:hover {
        background: #e0e0e0;
      }

      .message {
        margin-top: 15px;
        padding: 12px;
        border-radius: 8px;
        display: none;
      }

      .message.show {
        display: block;
      }

      .message.success {
        background: #d4edda;
        color: #155724;
        border: 1px solid #c3e6cb;
      }

      .message.error {
        background: #f8d7da;
        color: #721c24;
        border: 1px solid #f5c6cb;
      }

      .text-result {
        margin-top: 20px;
        padding: 15px;
        background: #f8f9ff;
        border-radius: 10px;
        display: none;
        max-height: 400px;
        overflow-y: auto;
      }

      .text-result.show {
        display: block;
      }

      .text-result-title {
        font-weight: bold;
        color: #333;
        margin-bottom: 10px;
        font-size: 18px;
      }

      .text-content {
        background: white;
        padding: 15px;
        border-radius: 8px;
        border: 1px solid #e0e0e0;
        white-space: pre-wrap;
        word-wrap: break-word;
        line-height: 1.6;
        color: #333;
        font-size: 14px;
      }

      .progress-container {
        margin-top: 15px;
        display: none;
      }

      .progress-container.show {
        display: block;
      }

      .progress-bar {
        width: 100%;
        height: 25px;
        background: #f0f0f0;
        border-radius: 12px;
        overflow: hidden;
        margin-bottom: 10px;
      }

      .progress-fill {
        height: 100%;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        width: 0%;
        transition: width 0.3s ease;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 12px;
        font-weight: bold;
      }

      .progress-text {
        text-align: center;
        color: #666;
        font-size: 14px;
        margin-top: 5px;
      }

      .copy-btn {
        margin-top: 10px;
        padding: 10px 20px;
        background: #667eea;
        color: white;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        font-size: 14px;
        font-weight: bold;
        transition: all 0.3s ease;
      }

      .copy-btn:hover {
        background: #764ba2;
        transform: translateY(-2px);
      }

      .api-key-section {
        margin-bottom: 20px;
        padding: 15px;
        background: #f8f9ff;
        border-radius: 10px;
        border: 1px solid #e0e0e0;
      }

      .api-key-label {
        font-weight: bold;
        color: #333;
        margin-bottom: 8px;
        font-size: 14px;
      }

      .api-key-input {
        width: 100%;
        padding: 12px;
        border: 2px solid #e0e0e0;
        border-radius: 8px;
        font-size: 14px;
        transition: border-color 0.3s ease;
      }

      .api-key-input:focus {
        outline: none;
        border-color: #667eea;
      }

      .salary-prediction {
        margin-top: 20px;
        padding: 20px;
        background: #fff8e1;
        border-radius: 10px;
        border: 2px solid #ffd54f;
        display: none;
      }

      .salary-prediction.show {
        display: block;
      }

      .salary-amount {
        text-align: center;
        margin-bottom: 20px;
        padding: 20px;
        background: linear-gradient(135deg, #ff9800 0%, #f57c00 100%);
        border-radius: 15px;
        color: white;
      }

      .salary-amount-label {
        font-size: 16px;
        font-weight: bold;
        margin-bottom: 10px;
        opacity: 0.9;
      }

      .salary-amount-value {
        font-size: 48px;
        font-weight: bold;
        margin: 10px 0;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
      }

      .salary-amount-range {
        font-size: 18px;
        opacity: 0.95;
        margin-top: 10px;
      }

      .salary-percentile {
        font-size: 20px;
        font-weight: bold;
        margin-top: 15px;
        padding: 10px 20px;
        background: rgba(255, 255, 255, 0.2);
        border-radius: 10px;
        display: inline-block;
      }

      .share-btn {
        margin-top: 15px;
        padding: 12px 24px;
        background: rgba(255, 255, 255, 0.3);
        color: white;
        border: 2px solid rgba(255, 255, 255, 0.5);
        border-radius: 10px;
        cursor: pointer;
        font-size: 16px;
        font-weight: bold;
        transition: all 0.3s ease;
      }

      .share-btn:hover {
        background: rgba(255, 255, 255, 0.4);
        border-color: rgba(255, 255, 255, 0.7);
        transform: translateY(-2px);
      }

      .salary-details {
        margin-top: 15px;
      }

      .salary-details-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 12px 15px;
        background: white;
        border-radius: 8px;
        border: 1px solid #e0e0e0;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .salary-details-header:hover {
        background: #f5f5f5;
        border-color: #ff9800;
      }

      .salary-details-title {
        font-weight: bold;
        color: #333;
        font-size: 16px;
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .salary-details-toggle {
        font-size: 20px;
        color: #666;
        transition: transform 0.3s ease;
      }

      .salary-details-toggle.expanded {
        transform: rotate(180deg);
      }

      .salary-details-content {
        background: white;
        padding: 15px;
        border-radius: 8px;
        border: 1px solid #e0e0e0;
        border-top: none;
        line-height: 1.8;
        color: #333;
        font-size: 14px;
        white-space: pre-wrap;
        word-wrap: break-word;
        display: none;
        margin-top: -1px;
      }

      .salary-details-content.show {
        display: block;
      }

      .predict-btn {
        background: linear-gradient(135deg, #ff9800 0%, #f57c00 100%);
        color: white;
        margin-top: 10px;
      }

      .predict-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(255, 152, 0, 0.4);
      }

      .predict-btn:disabled {
        background: #ccc;
        cursor: not-allowed;
        transform: none;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>ğŸ“„ ì´ë ¥ì„œ ë¶„ì„ ë° ì—°ë´‰ ì˜ˆì¸¡</h1>

      <div class="api-key-section">
        <div class="api-key-label">ğŸ”‘ Gemini API Key</div>
        <input
          type="password"
          class="api-key-input"
          id="apiKeyInput"
          placeholder="Gemini API Keyë¥¼ ì…ë ¥í•˜ì„¸ìš”"
        />
      </div>

      <div class="upload-area" id="uploadArea">
        <div class="upload-icon">ğŸ“</div>
        <div class="upload-text">
          PDF íŒŒì¼ì„ ë“œë˜ê·¸í•˜ì—¬ ë†“ê±°ë‚˜ í´ë¦­í•˜ì—¬ ì„ íƒí•˜ì„¸ìš”
        </div>
        <div class="upload-hint">PDF íŒŒì¼ë§Œ ì—…ë¡œë“œ ê°€ëŠ¥í•©ë‹ˆë‹¤</div>
        <input type="file" id="fileInput" accept=".pdf,application/pdf" />
      </div>

      <div class="file-info" id="fileInfo">
        <div class="file-name" id="fileName"></div>
        <div class="file-size" id="fileSize"></div>
      </div>

      <div class="buttons">
        <button class="upload-btn" id="uploadBtn" disabled>í…ìŠ¤íŠ¸ ì¶”ì¶œ</button>
        <button class="reset-btn" id="resetBtn">ì´ˆê¸°í™”</button>
      </div>

      <div class="progress-container" id="progressContainer">
        <div class="progress-bar">
          <div class="progress-fill" id="progressFill">0%</div>
        </div>
        <div class="progress-text" id="progressText">ì²˜ë¦¬ ì¤‘...</div>
      </div>

      <div class="text-result" id="textResult">
        <div class="text-result-title">ì¶”ì¶œëœ í…ìŠ¤íŠ¸:</div>
        <div class="text-content" id="textContent"></div>
        <button class="copy-btn" id="copyBtn">í…ìŠ¤íŠ¸ ë³µì‚¬</button>
        <button class="predict-btn copy-btn" id="predictBtn" disabled>
          ğŸ’° ì—°ë´‰ ì˜ˆì¸¡í•˜ê¸°
        </button>
      </div>

      <div class="salary-prediction" id="salaryPrediction">
        <div class="salary-amount">
          <div class="salary-amount-label">ğŸ’° ì˜ˆìƒ ì—°ë´‰</div>
          <div class="salary-amount-value" id="salaryAmount">-</div>
          <div class="salary-amount-range" id="salaryRange"></div>
          <div class="salary-percentile" id="salaryPercentile"></div>
          <button class="share-btn" id="shareBtn" style="display: none">
            ğŸ”— ê³µìœ í•˜ê¸°
          </button>
        </div>
        <div class="salary-details">
          <div class="salary-details-header" id="salaryDetailsHeader">
            <div class="salary-details-title">
              <span>ğŸ“‹</span>
              <span>ìƒì„¸ ë¶„ì„ ë‚´ì—­</span>
            </div>
            <div class="salary-details-toggle" id="salaryDetailsToggle">â–¼</div>
          </div>
          <div class="salary-details-content" id="salaryDetailsContent"></div>
        </div>
      </div>

      <div class="message" id="message"></div>
    </div>

    <script>
      const fileInput = document.getElementById("fileInput");
      const uploadArea = document.getElementById("uploadArea");
      const fileInfo = document.getElementById("fileInfo");
      const fileName = document.getElementById("fileName");
      const fileSize = document.getElementById("fileSize");
      const uploadBtn = document.getElementById("uploadBtn");
      const resetBtn = document.getElementById("resetBtn");
      const message = document.getElementById("message");
      const progressContainer = document.getElementById("progressContainer");
      const progressFill = document.getElementById("progressFill");
      const progressText = document.getElementById("progressText");
      const textResult = document.getElementById("textResult");
      const textContent = document.getElementById("textContent");
      const copyBtn = document.getElementById("copyBtn");
      const apiKeyInput = document.getElementById("apiKeyInput");
      const predictBtn = document.getElementById("predictBtn");
      const salaryPrediction = document.getElementById("salaryPrediction");
      const salaryAmount = document.getElementById("salaryAmount");
      const salaryRange = document.getElementById("salaryRange");
      const salaryPercentile = document.getElementById("salaryPercentile");
      const shareBtn = document.getElementById("shareBtn");
      const salaryDetailsHeader = document.getElementById(
        "salaryDetailsHeader"
      );
      const salaryDetailsToggle = document.getElementById(
        "salaryDetailsToggle"
      );
      const salaryDetailsContent = document.getElementById(
        "salaryDetailsContent"
      );

      let selectedFile = null;
      let isProcessing = false;
      let extractedText = "";

      // ë°±ë¶„ìœ„ ë°ì´í„° (ìƒìœ„ %, í‰ê· ì—°ë´‰)
      const percentileData = [
        { percentile: 0.1, salary: 96000 }, // 9ì–µ 6ì²œë§Œì›
        { percentile: 0.2, salary: 42000 }, // 4ì–µ 2ì²œë§Œì›
        { percentile: 0.3, salary: 33000 }, // 3ì–µ 3ì²œë§Œì›
        { percentile: 0.4, salary: 29000 }, // 2ì–µ 9ì²œë§Œì›
        { percentile: 0.5, salary: 26000 }, // 2ì–µ 6ì²œë§Œì›
        { percentile: 0.6, salary: 24000 }, // 2ì–µ 4ì²œë§Œì›
        { percentile: 0.7, salary: 22000 }, // 2ì–µ 2ì²œë§Œì›
        { percentile: 0.8, salary: 21000 }, // 2ì–µ 1ì²œë§Œì›
        { percentile: 0.9, salary: 20000 }, // 2ì–µ
        { percentile: 1.0, salary: 19000 }, // 1ì–µ 9ì²œë§Œì›
        { percentile: 2, salary: 17000 }, // 1ì–µ 7ì²œë§Œì›
        { percentile: 3, salary: 14000 }, // 1ì–µ 4ì²œë§Œì›
        { percentile: 4, salary: 13000 }, // 1ì–µ 3ì²œë§Œì›
        { percentile: 5, salary: 12000 }, // 1ì–µ 2ì²œë§Œì›
        { percentile: 6, salary: 11000 }, // 1ì–µ 1ì²œë§Œì›
        { percentile: 7, salary: 10000 }, // 1ì–µ
        { percentile: 8, salary: 10000 }, // 10ì²œë§Œì›
        { percentile: 9, salary: 9000 },
        { percentile: 10, salary: 9000 },
        { percentile: 11, salary: 8000 },
        { percentile: 12, salary: 8000 },
        { percentile: 13, salary: 8000 },
        { percentile: 14, salary: 8000 },
        { percentile: 15, salary: 7000 },
        { percentile: 16, salary: 7000 },
        { percentile: 17, salary: 7000 },
        { percentile: 18, salary: 7000 },
        { percentile: 19, salary: 7000 },
        { percentile: 20, salary: 6000 },
        { percentile: 21, salary: 6000 },
        { percentile: 22, salary: 6000 },
        { percentile: 23, salary: 6000 },
        { percentile: 24, salary: 6000 },
        { percentile: 25, salary: 6000 },
        { percentile: 26, salary: 5000 },
        { percentile: 27, salary: 5000 },
        { percentile: 28, salary: 5000 },
        { percentile: 29, salary: 5000 },
        { percentile: 30, salary: 5000 },
        { percentile: 31, salary: 5000 },
        { percentile: 32, salary: 5000 },
        { percentile: 33, salary: 5000 },
        { percentile: 34, salary: 4000 },
        { percentile: 35, salary: 4000 },
        { percentile: 36, salary: 4000 },
        { percentile: 37, salary: 4000 },
        { percentile: 38, salary: 4000 },
        { percentile: 39, salary: 4000 },
        { percentile: 40, salary: 4000 },
        { percentile: 41, salary: 4000 },
        { percentile: 42, salary: 4000 },
        { percentile: 43, salary: 4000 },
        { percentile: 44, salary: 4000 },
        { percentile: 45, salary: 4000 },
        { percentile: 46, salary: 4000 },
        { percentile: 47, salary: 3000 },
        { percentile: 48, salary: 3000 },
        { percentile: 49, salary: 3000 },
        { percentile: 50, salary: 3000 },
        { percentile: 51, salary: 3000 },
        { percentile: 52, salary: 3000 },
        { percentile: 53, salary: 3000 },
        { percentile: 54, salary: 3000 },
        { percentile: 55, salary: 3000 },
        { percentile: 56, salary: 3000 },
        { percentile: 57, salary: 3000 },
        { percentile: 58, salary: 3000 },
        { percentile: 59, salary: 3000 },
        { percentile: 60, salary: 3000 },
        { percentile: 61, salary: 3000 },
        { percentile: 62, salary: 3000 },
        { percentile: 63, salary: 3000 },
        { percentile: 64, salary: 3000 },
        { percentile: 65, salary: 3000 },
        { percentile: 66, salary: 2000 },
        { percentile: 67, salary: 2000 },
        { percentile: 68, salary: 2000 },
        { percentile: 69, salary: 2000 },
        { percentile: 70, salary: 2000 },
        { percentile: 71, salary: 2000 },
        { percentile: 72, salary: 2000 },
        { percentile: 73, salary: 2000 },
        { percentile: 74, salary: 2000 },
        { percentile: 75, salary: 2000 },
        { percentile: 76, salary: 2000 },
        { percentile: 77, salary: 2000 },
        { percentile: 78, salary: 2000 },
        { percentile: 79, salary: 2000 },
        { percentile: 80, salary: 2000 },
        { percentile: 81, salary: 1000 },
        { percentile: 82, salary: 1000 },
        { percentile: 83, salary: 1000 },
        { percentile: 84, salary: 1000 },
        { percentile: 85, salary: 1000 },
        { percentile: 86, salary: 1000 },
        { percentile: 87, salary: 1000 },
        { percentile: 88, salary: 1000 },
        { percentile: 89, salary: 1000 },
        { percentile: 90, salary: 1000 },
        { percentile: 91, salary: 1000 },
        { percentile: 92, salary: 1000 },
        { percentile: 93, salary: 1000 },
        { percentile: 94, salary: 0 },
        { percentile: 95, salary: 0 },
        { percentile: 96, salary: 0 },
        { percentile: 97, salary: 0 },
        { percentile: 98, salary: 0 },
        { percentile: 99, salary: 0 },
        { percentile: 100, salary: 0 },
      ];

      // ì˜ˆì¸¡ë°›ì€ ì—°ë´‰ì˜ ë°±ë¶„ìœ„ êµ¬ê°„ ì°¾ê¸°
      function findPercentileRange(salaryInManwon) {
        // ë°±ë¶„ìœ„ ë°ì´í„°ë¥¼ ì—°ë´‰ ìˆœìœ¼ë¡œ ì •ë ¬ (ë†’ì€ ìˆœ)
        const sortedData = [...percentileData].sort(
          (a, b) => b.salary - a.salary
        );

        // ì˜ˆì¸¡ë°›ì€ ì—°ë´‰ì´ ì–´ë–¤ ë°±ë¶„ìœ„ ì´ìƒì¸ì§€ ì°¾ê¸°
        for (let i = 0; i < sortedData.length; i++) {
          if (salaryInManwon >= sortedData[i].salary) {
            return sortedData[i].percentile;
          }
        }

        // ëª¨ë“  ë°±ë¶„ìœ„ë³´ë‹¤ ë‚®ìœ¼ë©´ ìƒìœ„ 100% (í•˜ìœ„ 0%)
        return 100;
      }

      // PDF.js ì„¤ì •
      pdfjsLib.GlobalWorkerOptions.workerSrc =
        "https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js";

      // URL íŒŒë¼ë¯¸í„°ì—ì„œ ì—°ë´‰ ì½ê¸° ë° í‘œì‹œ
      function loadSalaryFromURL() {
        const urlParams = new URLSearchParams(window.location.search);
        const salaryParam = urlParams.get("ì—°ë´‰");

        if (salaryParam) {
          // ì—°ë´‰ ê°’ì„ ë§Œì› ë‹¨ìœ„ ìˆ«ìë¡œ ë³€í™˜
          const salaryInManwon = parseInt(salaryParam);

          if (salaryInManwon > 0) {
            // ì—°ë´‰ í‘œì‹œ
            const salaryText = formatSalaryNumber(salaryInManwon);
            salaryAmount.textContent = salaryText;
            salaryRange.style.display = "none";

            // ë°±ë¶„ìœ„ ê³„ì‚° ë° í‘œì‹œ
            const percentile = findPercentileRange(salaryInManwon);
            let percentileText = "";

            if (percentile === 100) {
              percentileText = "ìƒìœ„ 100% (í•˜ìœ„ 0%)";
            } else if (percentile < 1) {
              percentileText = `ìƒìœ„ ${percentile.toFixed(1)}%`;
            } else {
              percentileText = `ìƒìœ„ ${percentile}%`;
            }

            salaryPercentile.textContent = `ğŸ“Š ${percentileText}`;
            salaryPercentile.style.display = "block";

            // ì—°ë´‰ ì˜ˆì¸¡ ì˜ì—­ í‘œì‹œ
            salaryPrediction.classList.add("show");

            // ìƒì„¸ë‚´ì—­ì€ ìˆ¨ê¹€ (URLë¡œ ë¡œë“œí•œ ê²½ìš°)
            salaryDetailsHeader.style.display = "none";
            salaryDetailsContent.style.display = "none";

            // ê³µìœ í•˜ê¸° ë²„íŠ¼ í‘œì‹œ
            shareBtn.style.display = "block";

            return true;
          }
        }

        return false;
      }

      // ê³µìœ í•˜ê¸° ê¸°ëŠ¥
      function shareSalary() {
        const salaryText = salaryAmount.textContent;
        if (salaryText === "-" || !salaryText) {
          showMessage("ì—°ë´‰ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.", "error");
          return;
        }

        // ì—°ë´‰ ê°’ì„ ë§Œì› ë‹¨ìœ„ ìˆ«ìë¡œ ì¶”ì¶œ
        const salaryInManwon = parseSalaryToNumber(salaryText);

        if (salaryInManwon <= 0) {
          showMessage("ì—°ë´‰ ì •ë³´ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.", "error");
          return;
        }

        // í˜„ì¬ URLì˜ ê¸°ë³¸ ê²½ë¡œ ê°€ì ¸ì˜¤ê¸°
        const baseUrl = window.location.origin + window.location.pathname;
        const shareUrl = `${baseUrl}?ì—°ë´‰=${salaryInManwon}`;

        // í´ë¦½ë³´ë“œì— ë³µì‚¬
        navigator.clipboard
          .writeText(shareUrl)
          .then(() => {
            showMessage("ê³µìœ  ë§í¬ê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!", "success");
          })
          .catch(() => {
            // í´ë¦½ë³´ë“œ APIê°€ ì§€ì›ë˜ì§€ ì•ŠëŠ” ê²½ìš° ëŒ€ì²´ ë°©ë²•
            const textArea = document.createElement("textarea");
            textArea.value = shareUrl;
            textArea.style.position = "fixed";
            textArea.style.opacity = "0";
            document.body.appendChild(textArea);
            textArea.select();
            try {
              document.execCommand("copy");
              showMessage("ê³µìœ  ë§í¬ê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!", "success");
            } catch (err) {
              showMessage(
                "ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. URLì„ ì§ì ‘ ë³µì‚¬í•´ì£¼ì„¸ìš”: " + shareUrl,
                "error"
              );
            }
            document.body.removeChild(textArea);
          });
      }

      // íŒŒì¼ í¬ê¸° í¬ë§·íŒ…
      function formatFileSize(bytes) {
        if (bytes === 0) return "0 Bytes";
        const k = 1024;
        const sizes = ["Bytes", "KB", "MB", "GB"];
        const i = Math.floor(Math.log(bytes) / Math.log(k));
        return (
          Math.round((bytes / Math.pow(k, i)) * 100) / 100 + " " + sizes[i]
        );
      }

      // íŒŒì¼ ì„ íƒ ì²˜ë¦¬
      function handleFileSelect(file) {
        if (!file) return;

        // PDF íŒŒì¼ì¸ì§€ í™•ì¸
        if (
          file.type !== "application/pdf" &&
          !file.name.toLowerCase().endsWith(".pdf")
        ) {
          showMessage("PDF íŒŒì¼ë§Œ ì—…ë¡œë“œ ê°€ëŠ¥í•©ë‹ˆë‹¤.", "error");
          return;
        }

        selectedFile = file;

        // íŒŒì¼ ì •ë³´ í‘œì‹œ
        fileName.textContent = `íŒŒì¼ëª…: ${file.name}`;
        fileSize.textContent = `í¬ê¸°: ${formatFileSize(file.size)}`;
        fileInfo.classList.add("show");

        uploadBtn.disabled = false;
        showMessage("íŒŒì¼ì´ ì„ íƒë˜ì—ˆìŠµë‹ˆë‹¤.", "success");
      }

      // ì—…ë¡œë“œ ì˜ì—­ í´ë¦­
      uploadArea.addEventListener("click", () => {
        fileInput.click();
      });

      // íŒŒì¼ ì…ë ¥ ë³€ê²½
      fileInput.addEventListener("change", (e) => {
        handleFileSelect(e.target.files[0]);
      });

      // ë“œë˜ê·¸ ì•¤ ë“œë¡­
      uploadArea.addEventListener("dragover", (e) => {
        e.preventDefault();
        uploadArea.classList.add("dragover");
      });

      uploadArea.addEventListener("dragleave", () => {
        uploadArea.classList.remove("dragover");
      });

      uploadArea.addEventListener("drop", (e) => {
        e.preventDefault();
        uploadArea.classList.remove("dragover");
        const file = e.dataTransfer.files[0];
        handleFileSelect(file);
      });

      // PDFë¥¼ ì´ë¯¸ì§€ë¡œ ë³€í™˜
      async function pdfToImages(pdfFile) {
        const arrayBuffer = await pdfFile.arrayBuffer();
        const pdf = await pdfjsLib.getDocument({ data: arrayBuffer }).promise;
        const numPages = pdf.numPages;
        const images = [];

        for (let pageNum = 1; pageNum <= numPages; pageNum++) {
          const page = await pdf.getPage(pageNum);
          const viewport = page.getViewport({ scale: 2.0 });

          const canvas = document.createElement("canvas");
          const context = canvas.getContext("2d");
          canvas.height = viewport.height;
          canvas.width = viewport.width;

          await page.render({
            canvasContext: context,
            viewport: viewport,
          }).promise;

          images.push(canvas.toDataURL("image/png"));

          // ì§„í–‰ë¥  ì—…ë°ì´íŠ¸ (PDF ë Œë”ë§ ë¶€ë¶„)
          const progress = (pageNum / numPages) * 30;
          updateProgress(
            progress,
            `PDF í˜ì´ì§€ ë Œë”ë§ ì¤‘... (${pageNum}/${numPages})`
          );
        }

        return images;
      }

      // Tesseract.jsë¡œ ì´ë¯¸ì§€ì—ì„œ í…ìŠ¤íŠ¸ ì¶”ì¶œ
      async function extractTextFromImages(images) {
        let allText = "";
        const totalImages = images.length;

        for (let i = 0; i < images.length; i++) {
          const image = images[i];

          // ì§„í–‰ë¥  ì—…ë°ì´íŠ¸ (OCR ì²˜ë¦¬ ë¶€ë¶„)
          const baseProgress = 30;
          const ocrProgress = ((i + 1) / totalImages) * 70;
          updateProgress(
            baseProgress + ocrProgress,
            `OCR ì²˜ë¦¬ ì¤‘... (${i + 1}/${totalImages})`
          );

          try {
            const {
              data: { text },
            } = await Tesseract.recognize(image, "kor+eng", {
              logger: (m) => {
                if (m.status === "recognizing text") {
                  const progressPercent = Math.round(m.progress * 100);
                  const overallProgress =
                    baseProgress +
                    (i / totalImages) * 70 +
                    (ocrProgress * progressPercent) / 100 / totalImages;
                  updateProgress(
                    overallProgress,
                    `OCR ì²˜ë¦¬ ì¤‘... í˜ì´ì§€ ${
                      i + 1
                    }/${totalImages} (${progressPercent}%)`
                  );
                }
              },
            });

            allText += text + "\n\n";
          } catch (error) {
            console.error(`í˜ì´ì§€ ${i + 1} ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜:`, error);
            showMessage(
              `í˜ì´ì§€ ${i + 1} ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.`,
              "error"
            );
          }
        }

        return allText.trim();
      }

      // ì§„í–‰ë¥  ì—…ë°ì´íŠ¸
      function updateProgress(percent, text) {
        const clampedPercent = Math.min(100, Math.max(0, Math.round(percent)));
        progressFill.style.width = clampedPercent + "%";
        progressFill.textContent = clampedPercent + "%";
        progressText.textContent = text || "ì²˜ë¦¬ ì¤‘...";
      }

      // ì—…ë¡œë“œ ë²„íŠ¼ (í…ìŠ¤íŠ¸ ì¶”ì¶œ ì‹œì‘)
      uploadBtn.addEventListener("click", async () => {
        if (!selectedFile || isProcessing) return;

        isProcessing = true;
        uploadBtn.disabled = true;
        textResult.classList.remove("show");
        progressContainer.classList.add("show");
        updateProgress(0, "PDF íŒŒì¼ ì½ëŠ” ì¤‘...");

        try {
          // PDFë¥¼ ì´ë¯¸ì§€ë¡œ ë³€í™˜
          const images = await pdfToImages(selectedFile);

          // ì´ë¯¸ì§€ì—ì„œ í…ìŠ¤íŠ¸ ì¶”ì¶œ
          const text = await extractTextFromImages(images);

          // ê²°ê³¼ í‘œì‹œ
          extractedText = text || "í…ìŠ¤íŠ¸ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.";
          textContent.textContent = extractedText;
          textResult.classList.add("show");
          updateProgress(100, "ì™„ë£Œ!");
          showMessage("í…ìŠ¤íŠ¸ ì¶”ì¶œì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!", "success");

          // ì—°ë´‰ ì˜ˆì¸¡ ë²„íŠ¼ í™œì„±í™”
          if (extractedText && extractedText !== "í…ìŠ¤íŠ¸ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.") {
            predictBtn.disabled = false;
          }

          setTimeout(() => {
            progressContainer.classList.remove("show");
          }, 2000);
        } catch (error) {
          console.error("í…ìŠ¤íŠ¸ ì¶”ì¶œ ì˜¤ë¥˜:", error);
          showMessage(
            "í…ìŠ¤íŠ¸ ì¶”ì¶œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: " + error.message,
            "error"
          );
          progressContainer.classList.remove("show");
        } finally {
          isProcessing = false;
          uploadBtn.disabled = false;
        }
      });

      // ê¸ˆì•¡ì„ ë§Œì› ë‹¨ìœ„ ìˆ«ìë¡œ ë³€í™˜ (ì˜ˆ: "8,000ë§Œì›" â†’ 8000, "1ì–µ 2,000ë§Œì›" â†’ 12000)
      function parseSalaryToNumber(salaryStr) {
        if (!salaryStr) return 0;

        // ì½¤ë§ˆ ì œê±°
        const cleanStr = salaryStr.replace(/,/g, "");

        let total = 0;

        // "ì–µ" ë‹¨ìœ„ ì²˜ë¦¬ (ì˜ˆ: "1ì–µ 2,000ë§Œì›" â†’ 1ì–µ + 2,000ë§Œì›)
        const eokMatch = cleanStr.match(/(\d+)\s*ì–µ/);
        if (eokMatch) {
          total += parseInt(eokMatch[1]) * 10000; // 1ì–µ = 10,000ë§Œì›
        }

        // "ë§Œì›" ë‹¨ìœ„ ì²˜ë¦¬
        const manMatch = cleanStr.match(/(\d+)\s*ë§Œì›?/);
        if (manMatch) {
          total += parseInt(manMatch[1]);
        }

        // "ì–µ"ì´ë‚˜ "ë§Œì›"ì´ ì—†ê³  ìˆ«ìë§Œ ìˆëŠ” ê²½ìš° (ë§Œì›ìœ¼ë¡œ ê°€ì •)
        if (total === 0) {
          const numMatch = cleanStr.match(/(\d+)/);
          if (numMatch) {
            total = parseInt(numMatch[1]);
          }
        }

        return total;
      }

      // ìˆ«ìë¥¼ ë§Œì› í˜•ì‹ ë¬¸ìì—´ë¡œ ë³€í™˜ (ì˜ˆ: 10000 â†’ "10,000ë§Œì›")
      function formatSalaryNumber(num) {
        if (num === 0) return "0ë§Œì›";
        return num.toLocaleString("ko-KR") + "ë§Œì›";
      }

      // Gemini API ì‘ë‹µì—ì„œ ì—°ë´‰ ì •ë³´ íŒŒì‹±
      function parseSalaryResponse(response) {
        let salary = "-";
        let range = "";
        let details = response;

        // "ì˜ˆìƒ ì—°ë´‰:" ë˜ëŠ” "**ì˜ˆìƒ ì—°ë´‰:**" ë‹¤ìŒ ì¤„ ì°¾ê¸°
        // ì—¬ëŸ¬ ì¤„ì— ê±¸ì³ ìˆì„ ìˆ˜ ìˆìœ¼ë¯€ë¡œ ë” í¬ê´„ì ìœ¼ë¡œ ê²€ìƒ‰
        const salaryHeaderPatterns = [
          /(?:\*\*)?ì˜ˆìƒ\s*ì—°ë´‰\s*:?\*?\*?\s*\n?\s*([^\n]+)/i,
          /ì˜ˆìƒ\s*ì—°ë´‰\s*:?\s*([^\n]+)/i,
          /ì—°ë´‰\s*:?\s*([^\n]+)/i,
        ];

        let salaryText = "";

        for (const pattern of salaryHeaderPatterns) {
          const match = response.match(pattern);
          if (match && match[1]) {
            salaryText = match[1].trim();
            // ë§ˆí¬ë‹¤ìš´ í˜•ì‹ ì œê±°
            salaryText = salaryText.replace(/\*\*/g, "").trim();
            break;
          }
        }

        if (!salaryText) {
          // ì „ì²´ í…ìŠ¤íŠ¸ì—ì„œ ì—°ë´‰ íŒ¨í„´ ì°¾ê¸° (ë” í¬ê´„ì ì¸ íŒ¨í„´)
          // "8,000ë§Œì› ~ 1ì–µ 2,000ë§Œì›" í˜•ì‹ë„ ì°¾ì„ ìˆ˜ ìˆë„ë¡
          const salaryPatterns = [
            // ë²”ìœ„ íŒ¨í„´: "ìˆ«ìë§Œì› ~ ìˆ«ìì–µ ìˆ«ìë§Œì›"
            /(\d{1,3}(?:,\d{3})*)\s*ë§Œì›\s*(?:~|~|~|-|~|~|~)\s*(\d{1,3}(?:,\d{3})*)?\s*ì–µ\s*(\d{1,3}(?:,\d{3})*)?\s*ë§Œì›?/,
            // ë²”ìœ„ íŒ¨í„´: "ìˆ«ìë§Œì› ~ ìˆ«ìë§Œì›"
            /(\d{1,3}(?:,\d{3})*)\s*ë§Œì›\s*(?:~|~|~|-|~|~|~)\s*(\d{1,3}(?:,\d{3})*)\s*ë§Œì›?/,
            // ë‹¨ì¼ ê°’: "ìˆ«ìì–µ ìˆ«ìë§Œì›" ë˜ëŠ” "ìˆ«ìë§Œì›"
            /(\d{1,3}(?:,\d{3})*)?\s*ì–µ\s*(\d{1,3}(?:,\d{3})*)?\s*ë§Œì›?/,
            /(\d{1,3}(?:,\d{3})*)\s*ë§Œì›?/,
          ];

          for (const pattern of salaryPatterns) {
            const match = response.match(pattern);
            if (match) {
              salaryText = match[0];
              break;
            }
          }
        }

        if (salaryText) {
          // ë²”ìœ„ íŒ¨í„´ ì°¾ê¸° (ì˜ˆ: "8,000ë§Œì› ~ 1ì–µ 2,000ë§Œì›", "3,500ë§Œì› ~ 4,500ë§Œì›")
          // ë‹¤ì–‘í•œ êµ¬ë¶„ì ì§€ì›: ~, -, ~ ë“± (ê³µë°± í—ˆìš©)
          const rangePattern = /(.+?)\s*(?:~|~|~|-)\s*(.+)/;
          const rangeMatch = salaryText.match(rangePattern);

          if (rangeMatch) {
            // ë²”ìœ„ê°€ ìˆëŠ” ê²½ìš°
            const minStr = rangeMatch[1].trim();
            const maxStr = rangeMatch[2].trim();

            const min = parseSalaryToNumber(minStr);
            const max = parseSalaryToNumber(maxStr);

            if (min > 0 && max > 0) {
              // í‰ê· ê°’ ê³„ì‚°
              const average = Math.round((min + max) / 2);
              salary = formatSalaryNumber(average);
              range = `${formatSalaryNumber(min)} ~ ${formatSalaryNumber(max)}`;
            } else if (min > 0) {
              salary = formatSalaryNumber(min);
            } else if (max > 0) {
              salary = formatSalaryNumber(max);
            }
          } else {
            // ë‹¨ì¼ ê°’ì¸ ê²½ìš°
            const singleValue = parseSalaryToNumber(salaryText);
            if (singleValue > 0) {
              salary = formatSalaryNumber(singleValue);
            }
          }
        }

        // ìƒì„¸ë‚´ì—­ì—ì„œ ì—°ë´‰ ê´€ë ¨ ë¶€ë¶„ ì œê±°
        if (salary !== "-") {
          // "ì˜ˆìƒ ì—°ë´‰:" ì„¹ì…˜ ì œê±°
          details = response
            .replace(/(?:\*\*)?ì˜ˆìƒ\s*ì—°ë´‰\s*:?\*?\*?\s*\n?[^\n]*\n?/i, "")
            .trim();

          // ì—°ë´‰ ìˆ«ìê°€ í¬í•¨ëœ ì¤„ ì œê±° (ë‹¨, ê·¼ê±°ë‚˜ ê¸°ì¤€ì´ í¬í•¨ëœ ì¤„ì€ ìœ ì§€)
          details = details
            .split("\n")
            .filter((line) => {
              const lineLower = line.toLowerCase();
              const hasSalary =
                /\d{1,3}(?:,\d{3})*\s*(?:ì–µ\s*)?\d{0,3}(?:,\d{3})*\s*ë§Œì›/.test(
                  line
                );
              const hasReason =
                lineLower.includes("ê·¼ê±°") ||
                lineLower.includes("ê¸°ì¤€") ||
                lineLower.includes("ë¶„ì„");
              return !hasSalary || hasReason;
            })
            .join("\n")
            .trim();
        }

        // ìƒì„¸ë‚´ì—­ì´ ë¹„ì–´ìˆìœ¼ë©´ ì „ì²´ ì‘ë‹µ ì‚¬ìš©
        if (!details || details.trim() === "") {
          details = response;
        }

        return { salary, range, details };
      }

      // ê³µìœ í•˜ê¸° ë²„íŠ¼ í´ë¦­
      shareBtn.addEventListener("click", shareSalary);

      // í˜ì´ì§€ ë¡œë“œ ì‹œ URL íŒŒë¼ë¯¸í„° í™•ì¸
      window.addEventListener("DOMContentLoaded", () => {
        loadSalaryFromURL();
      });

      // ìƒì„¸ë‚´ì—­ ì ‘ê¸°/í¼ì¹˜ê¸°
      salaryDetailsHeader.addEventListener("click", () => {
        const isExpanded = salaryDetailsContent.classList.contains("show");
        if (isExpanded) {
          salaryDetailsContent.classList.remove("show");
          salaryDetailsToggle.classList.remove("expanded");
        } else {
          salaryDetailsContent.classList.add("show");
          salaryDetailsToggle.classList.add("expanded");
        }
      });

      // Gemini APIë¡œ ì—°ë´‰ ì˜ˆì¸¡
      async function predictSalary(resumeText, apiKey) {
        if (!apiKey || apiKey.trim() === "") {
          throw new Error("API Keyë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.");
        }

        if (!resumeText || resumeText.trim() === "") {
          throw new Error("ì´ë ¥ì„œ í…ìŠ¤íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤.");
        }

        const prompt = `ë‹¤ìŒì€ ì´ë ¥ì„œ í…ìŠ¤íŠ¸ì…ë‹ˆë‹¤. ì´ ì´ë ¥ì„œë¥¼ ë¶„ì„í•˜ì—¬ ì˜ˆìƒ ì—°ë´‰ì„ ì¶”ì •í•´ì£¼ì„¸ìš”.

ì´ë ¥ì„œ ë‚´ìš©:
${resumeText}

ë‹¤ìŒ í˜•ì‹ìœ¼ë¡œ ì‘ë‹µí•´ì£¼ì„¸ìš”:

**ì˜ˆìƒ ì—°ë´‰:**
[ì˜ˆ: 3,500ë§Œì› ë˜ëŠ” 3,500ë§Œì› ~ 4,500ë§Œì›]

**ìƒì„¸ ë¶„ì„:**
1. í˜„ì¬ ê²½ë ¥ ìˆ˜ì¤€ (ì‹ ì…/ì£¼ë‹ˆì–´/ì‹œë‹ˆì–´ ë“±)
2. ë³´ìœ  ê¸°ìˆ  ë° ìŠ¤íƒ
3. ê²½ë ¥ ê¸°ê°„
4. ì—°ë´‰ ì˜ˆì¸¡ ê·¼ê±°

í•œêµ­ IT/ê°œë°œì ì‹œì¥ ê¸°ì¤€ìœ¼ë¡œ í˜„ì‹¤ì ì¸ ì—°ë´‰ì„ ì¶”ì •í•´ì£¼ì„¸ìš”.`;

        const response = await fetch(
          "https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash-exp:generateContent",
          {
            method: "POST",
            headers: {
              "x-goog-api-key": apiKey,
              "Content-Type": "application/json",
            },
            body: JSON.stringify({
              contents: [
                {
                  parts: [
                    {
                      text: prompt,
                    },
                  ],
                },
              ],
            }),
          }
        );

        if (!response.ok) {
          const errorData = await response.json().catch(() => ({}));
          throw new Error(
            errorData.error?.message ||
              `API ìš”ì²­ ì‹¤íŒ¨: ${response.status} ${response.statusText}`
          );
        }

        const data = await response.json();

        if (
          data.candidates &&
          data.candidates[0] &&
          data.candidates[0].content &&
          data.candidates[0].content.parts &&
          data.candidates[0].content.parts[0] &&
          data.candidates[0].content.parts[0].text
        ) {
          return data.candidates[0].content.parts[0].text;
        } else {
          throw new Error("API ì‘ë‹µ í˜•ì‹ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.");
        }
      }

      // ì—°ë´‰ ì˜ˆì¸¡ ë²„íŠ¼
      predictBtn.addEventListener("click", async () => {
        if (!extractedText || extractedText === "í…ìŠ¤íŠ¸ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.") {
          showMessage("ë¨¼ì € í…ìŠ¤íŠ¸ë¥¼ ì¶”ì¶œí•´ì£¼ì„¸ìš”.", "error");
          return;
        }

        const apiKey = apiKeyInput.value.trim();
        if (!apiKey) {
          showMessage("API Keyë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.", "error");
          apiKeyInput.focus();
          return;
        }

        isProcessing = true;
        predictBtn.disabled = true;
        salaryPrediction.classList.remove("show");
        progressContainer.classList.add("show");
        updateProgress(0, "Gemini APIë¡œ ì—°ë´‰ ì˜ˆì¸¡ ì¤‘...");

        try {
          const prediction = await predictSalary(extractedText, apiKey);

          // ì—°ë´‰ê³¼ ìƒì„¸ë‚´ì—­ ë¶„ë¦¬
          const { salary, range, details } = parseSalaryResponse(prediction);

          // ì—°ë´‰ í‘œì‹œ (í‰ê· ê°’ í•˜ë‚˜ë§Œ í‘œì‹œ)
          salaryAmount.textContent = salary;
          // ë²”ìœ„ëŠ” ìˆ¨ê¹€ (í‰ê· ê°’ë§Œ í‘œì‹œ)
          salaryRange.style.display = "none";

          // ë°±ë¶„ìœ„ êµ¬ê°„ ê³„ì‚° ë° í‘œì‹œ
          const salaryInManwon = parseSalaryToNumber(salary);
          if (salaryInManwon > 0) {
            const percentile = findPercentileRange(salaryInManwon);
            let percentileText = "";

            if (percentile === 100) {
              percentileText = "ìƒìœ„ 100% (í•˜ìœ„ 0%)";
            } else if (percentile < 1) {
              percentileText = `ìƒìœ„ ${percentile.toFixed(1)}%`;
            } else {
              percentileText = `ìƒìœ„ ${percentile}%`;
            }

            salaryPercentile.textContent = `ğŸ“Š ${percentileText}`;
            salaryPercentile.style.display = "block";

            // ê³µìœ í•˜ê¸° ë²„íŠ¼ í‘œì‹œ
            shareBtn.style.display = "block";
          } else {
            salaryPercentile.style.display = "none";
            shareBtn.style.display = "none";
          }

          // ìƒì„¸ë‚´ì—­ í‘œì‹œ
          salaryDetailsContent.textContent = details || prediction;

          salaryPrediction.classList.add("show");
          updateProgress(100, "ì™„ë£Œ!");
          showMessage("ì—°ë´‰ ì˜ˆì¸¡ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!", "success");

          setTimeout(() => {
            progressContainer.classList.remove("show");
          }, 2000);
        } catch (error) {
          console.error("ì—°ë´‰ ì˜ˆì¸¡ ì˜¤ë¥˜:", error);
          showMessage(
            "ì—°ë´‰ ì˜ˆì¸¡ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: " + error.message,
            "error"
          );
          progressContainer.classList.remove("show");
        } finally {
          isProcessing = false;
          predictBtn.disabled = false;
        }
      });

      // í…ìŠ¤íŠ¸ ë³µì‚¬ ë²„íŠ¼
      copyBtn.addEventListener("click", async () => {
        const text = textContent.textContent;
        try {
          await navigator.clipboard.writeText(text);
          showMessage("í…ìŠ¤íŠ¸ê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!", "success");
        } catch (error) {
          // í´ë¦½ë³´ë“œ APIê°€ ì§€ì›ë˜ì§€ ì•ŠëŠ” ê²½ìš° ëŒ€ì²´ ë°©ë²•
          const textArea = document.createElement("textarea");
          textArea.value = text;
          textArea.style.position = "fixed";
          textArea.style.opacity = "0";
          document.body.appendChild(textArea);
          textArea.select();
          try {
            document.execCommand("copy");
            showMessage("í…ìŠ¤íŠ¸ê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!", "success");
          } catch (err) {
            showMessage("ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.", "error");
          }
          document.body.removeChild(textArea);
        }
      });

      // ì´ˆê¸°í™” ë²„íŠ¼
      resetBtn.addEventListener("click", () => {
        if (isProcessing) {
          showMessage("ì²˜ë¦¬ ì¤‘ì…ë‹ˆë‹¤. ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”.", "error");
          return;
        }
        fileInput.value = "";
        selectedFile = null;
        fileInfo.classList.remove("show");
        textResult.classList.remove("show");
        salaryPrediction.classList.remove("show");
        progressContainer.classList.remove("show");
        uploadBtn.disabled = true;
        predictBtn.disabled = true;
        message.classList.remove("show");
        extractedText = "";
        isProcessing = false;
      });

      // ë©”ì‹œì§€ í‘œì‹œ
      function showMessage(text, type) {
        message.textContent = text;
        message.className = `message show ${type}`;
        setTimeout(() => {
          message.classList.remove("show");
        }, 3000);
      }
    </script>
  </body>
</html>
